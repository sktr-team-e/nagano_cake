<h2>ショッピングカート</h2>

<div class="pull-right margin-bottom text-right">
  <%= link_to " カートを空にする", cart_products_path, method: :delete, data: {confirm: 'カートを空にして本当によろしいですか？'}, class: "glyphicon glyphicon-trash btn btn-danger" %>
</div>
<br>

<div calss="row">
  <div class="col-xs-11" id="no_cart">
    <table class="table table-hover table-bordered">
      <thead>
        <tr class="info">
          <th>商品名</th>
          <th>単価(税込)</th>
          <th>数量</th>
          <th>小計</th>
          <th></th>
        </tr>
      </thead>

      <tbody>
        <% @cart_products.each do |cart_product| %>
        <tr>
          <td>
            <%= attachment_image_tag(cart_product.product, :image, size:"30x30", fallback: "no_image.jpg") %>
            <%= cart_product.product.name %>
          </td>
          <td><%= cart_product.product.nontaxed_price %></td><!--税込価格挿入-->
          <td>
            <%= form_with model: cart_product, url: cart_product_path(cart_product.id), local: true do |f| %>
              <%= f.number_field :amount,:value => cart_product.amount, min:1,max:5 %>
              <%= f.submit "変更"%>
            <% end %>
          </td>

          <td></td><!--小計が出るように挿入-->
          <td><%= link_to '削除する', cart_products_path, method: :delete, data: { confirm: '本当に消しますか？' }, class: "btn btn-sm btn-danger destroy_cart_product_#{@cart_products}"%></td>
        </tr>
        <% end %>
      </tbody>
    </table>

    <div class="col-xs-9 margin-bottom">
      <div class ="action">
        <%= link_to " 買い物を続ける", root_path, class: "glyphicon glyphicon-shopping-cart btn btn-info" %>
      </div>
    </div>
    <br>
    <div class="col-xs-3 pull-right billing">
      <table class="table table-bordered text-right">
        <thead>
          <tr>
            <td class="warning">合計金額</td>
            <td class="text-right" id='total_price'>
              <!--合計金額が出るように挿入する-->
            </td>
          </tr>
        </thead>
      </table>
    </div>

    <div class="col-md-4 col-md-offset-4 text-center">
      <%= link_to " 情報入力に進む", new_order_path, data: {"turbolinks" => false}, class: "glyphicon glyphicon-pencil btn btn-success center-block" %>
    </div>

  </div>
</div>
